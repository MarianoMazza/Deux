{% extends 'base.html.twig' %}

{% if is_granted('IS_AUTHENTICATED_FULLY') %}
    {% block panelhead %}
    Publicacion
    <a href="{{ path('_calificarPublicacion', {'id': publicacion.id, 'cal':1}) }}" class="glyphicon glyphicon-thumbs-up" style="color: green">
    </a>
    {{ calificacionesBuenas }}
    <a href="{{ path('_calificarPublicacion', {'id': publicacion.id, 'cal':2}) }}" class="glyphicon glyphicon-thumbs-down" style="color: red">
    </a>
    {{ calificacionesMalas }}
{% endblock %}
{% endif %}

{% block panelbody %}
    <div class="col-md-8">
        <div>
            <label>Tipo de hospedaje</label><br>
            {{ publicacion.tipo.tipo }}
        </div>
        <br><br>
    {% if is_granted('IS_AUTHENTICATED_FULLY') %}
        <div>
            <label>Fecha Disponible:</label><br>
            Desde: {{ publicacion.fechaDisponibleInicio|date('Y-m-d') }}<br>
            Hasta: {{ publicacion.fechaDisponibleFin|date('Y-m-d') }}
        </div>
        <br><br>
    {% endif %}
        <div>
            <label>Descripcion:</label><br>
            {{ publicacion.descripcion }}
        </div>
        <br><br>
    {% if is_granted('IS_AUTHENTICATED_FULLY') %}
        <div>
            <label>¿Dónde queda?</label><br>
            Pais:
            {{ publicacion.pais }}<br>
            Provincia:
            {{ publicacion.localidad }}<br>
            Dirección:
            {{ publicacion.calle }}<br>
        </div>
        {% endif %}
    </div>

    <div class="col-md-4">
    {% if is_granted('IS_AUTHENTICATED_FULLY') %}
        <div>
            <label>Publicado por:</label>
            {{ publicacion.usuario.username }}
            <a href="{{ path('_calificacionUsuario', {'paraUsuario': publicacion.usuario.id, 'cal': 1, 'publicacionid': publicacion.id}) }}" class="glyphicon glyphicon-thumbs-up" style="color: green"></a>
            {{ calificacionDelUsuarioBuenas }}
            <a href="{{ path('_calificacionUsuario', {'paraUsuario': publicacion.usuario.id, 'cal': 2, 'publicacionid': publicacion.id}) }}" class="glyphicon glyphicon-thumbs-down" style="color: red"></a>
            {{ calificacionesDelUsuarioMalas }}
        </div>
        <br>
        <div>
            <label>El día:</label>
            {{ publicacion.fechaDePublicacion|date('Y-m-d') }}
        </div>
    {% endif %}
        <div>
            <img class="img-responsive" src="{{ asset('uploads/fotos/' ~ publicacion.path) }}">
        </div>
    {% if is_granted('IS_AUTHENTICATED_FULLY') %}
    </div>
    <div class="panel-heading col-md-12" style="padding: 20px 0px">

        <ul class="nav nav-tabs">
            <li class="active"><a><label style="color: white">Comentarios</label></a></li>
        </ul>

        <div id="comentarios"><br>
            <a href="{{path('_comentario', {'paraUsuarioId':publicacion.usuario.id, 'id': publicacion.id})}}" class="btn btn-default active">Comentar</a>
            <br><br>
            <table class="table panel-body col-md-12">
                <tbody>
                {% for comentario in comentarios %}
                    <tr>
                        <td>
                            <div style="padding: 20px 0px">
                                Usuario: {{ comentario.deUsuario.username }}<br>
                            </div>
                        </td>
                        <td>
                            <div>
                                Fecha: {{ comentario.fecha|date('Y-m-d') }}
                            </div>
                        </td>
                        <td>
                            <div>
                                Comentario: {{ comentario.comentario }}
                            </div>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
        <div id="pregunta"><br>
            <a href="{{path('_nuevaPregunta', {'paraUsuarioId':publicacion.usuario.id, 'id': publicacion.id})}}"
               class="btn btn-default active">Hacer una pregunta</a>
        </div>
    {% endif %}
    </div>

{% endblock %}